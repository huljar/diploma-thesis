% TODO: tenses?
\section{Network-On-Chip Security}\label{sec:networkonchipsecurity}
Research on new and efficient ways to interconnect components on a single chip has been an important field of research for decades. The concept of
general-purpose on-chip networks has been introduced in the early 2000s
\cites{dally01routepacketsnotwires}{kumar02networkonchip}{benini02nocparadigm} and has quickly gained a lot of traction in the research community
\cite[e.g.][]{ivanov05nocintroduction}. 
%\Glspl{mpsoc} that utilize \glspl{noc} typically have a large number of processing elements that can run many different
%tasks in parallel. \citeauthor{ancajas14fortnocs} have shown that the threat is relevant, especially in cloud computing setups, where several
%untrusted applications may run at the same time \cite{ancajas14fortnocs}. % TODO: move this out of related work? also drop the untrusted applications part

In recent research, many different attack vectors on \gls{noc} architectures have been explored, and a variety of countermeasures have been proposed
to mitigate attacks. The remainder of this section will explore them in detail.

% HT Survey & building trustworthy hardware
\citeauthor{bhunia14hardwaretrojans} \cite{bhunia14hardwaretrojans} have looked thoroughly into the threat of hardware trojans and possible protection
approaches. In a survey-like paper, they provide a detailed summary of attack scenarios, countermeasures, and detection paradigms. Similarly,
\citeauthor{sethumadhavan15trustworthyhardware} \cite{sethumadhavan15trustworthyhardware} analyze the challenge of building systems from untrusted
hardware components. They explain in detail how the hardware design and fabrication chain can be adapted to significantly lower the probability of
integrating malicious components. The methods in both works are not specific to \gls{noc} architectures, but are applicable to them nonetheless.

% Security zones
The necessity of security measures as part of the design was already recognized early on in \gls{noc} research. A popular approach is to
divide the \gls{noc} into security zones with different levels of protection, where sensitive information is handled exclusively inside a
high-security zone \cites(e.g.)(){gebotys03securityframework}{fernandes16nocrouting}{kapoor13nocauthenc}.

Published in 2003, \citeauthor{gebotys03securityframework} \cite{gebotys03securityframework} were among the first to propose a \enquote{general security architecture}
\cite[1]{gebotys03securityframework} to impede attacks \enquote{at both the network level […] and at the core level}
\cite[1]{gebotys03securityframework}. At the network level, they differentiate between secure cores and other cores, thus establishing two security
zones. The secure cores are capable of encrypting and authenticating network
traffic, and are thus designed to handle sensitive user information. In addition, there is a dedicated key-keeper core that handles key distribution
amongst the secure cores. At the core level (or application level), the authors propose to use a modified implementation of elliptic curve
cryptography to facilitate encryption and authentication. Aiming to provide resistance against side channel power attacks, their modifications conceal
the power traces of the different algebraic computations during the cryptographic operations. This hinders adversaries from extracting key bits based
on power spikes.

\citeauthor{kapoor13nocauthenc} \cite{kapoor13nocauthenc} have pursued a similar approach. They also separate the cores into secure and non-secure
ones and propose to implement authenticated encryption in the network interfaces. While the secure
cores employ permanent keys to communicate with each other, the non-secure ones may use plain text messages. Additionally, in order to allow
communication between the security zones, sessions may be established with individually generated session keys. Furthermore, the authors employ
traffic limitations in the network interfaces to prevent \gls{dos} attacks by malicious cores, while access rights tables prohibit unauthorized
memory accesses.

Another work that revolves around security zones in \glspl{noc} was published by \citeauthor{fernandes16nocrouting} \cite{fernandes16nocrouting}.
However, in contrast to the papers presented above, they deem the underlying hardware to be secure. Assuming that \enquote{software attacks account
for 80\% of security incidents in embedded systems} \cite[1]{fernandes16nocrouting}, their work focuses on the defense against software-based
\gls{dos} and timing attacks.

The goal of the authors is to ensure that packets from one security zone are not routed through nodes of a different zone, if possible. To achieve
this, they have adapted the routing algorithm of the network to prioritize paths that do not cross zone boundaries. In addition, they have
refined the algorithm to guarantee deadlock freedom despite the constraints imposed by the security zones.

% Fort-NoCs
\citeauthor{ancajas14fortnocs} \cite{ancajas14fortnocs} have investigated the threat of hardware trojans for \glspl{noc}. They show that the usage of
third party \gls{noc} \gls{ip} is very popular due to cost efficiency, opening up an infection vector for hardware
trojans. Together with a software accomplice (i.e. an infected processing element) that can send commands to the trojan, this may
lead to information leaks, data corruption or denial of service attacks.

The authors focus on mitigating \enquote{covert data theft by a compromised \gls{noc}} \cite[3]{ancajas14fortnocs}. They suggest a three-layer
approach to mitigate this threat, consisting of data scrambling, packet certification, and node obfuscation. These techniques are
implemented solely in the network interfaces, which are not provided by a third party and hence assumed to be trustworthy. The goal of these measures
is to prevent activation of the hardware trojan and render transmitted information unreadable to the attacker.

% Hardened NoC design
\citeauthor{frey17hardenednoc} \cite{frey17hardenednoc} also worked on mitigating the effect of hardware trojans in a \gls{noc}. Their goal is to
harden the \gls{noc} design against potential hardware trojans located inside the routers. In contrast to \citeauthor{ancajas14fortnocs}
\cite{ancajas14fortnocs}, the protective measures are implemented at the router level and not in the network interfaces. They are designed to
\enquote{complement […] the previous \gls{noc} works aiming for \gls{ni} security} \cite[16]{frey17hardenednoc} and address \gls{dos} attacks rather
than information leakage.

The idea of the authors is to detect any flit tampering right after the flit leaves a router. To achieve this, an error control code and dynamic flit
permutation are applied to all flits before they enter a router, and the reverse transformations are applied after they exit the router again. This
prevents (or at least detects) small and targeted modifications to the flit headers. % TODO: not the best wording

% AMD codes
\citeauthor{boraten16packetsecurity} pursue a very similar approach. In their 2016 paper \cite{boraten16packetsecurity}, they propose to apply
\gls{amd} and \gls{crc} codes in the network interfaces to protect packets from fault injections by a malicious \gls{noc}. The authors suggest to use
\gls{amd} codes for sensitive data and \gls{crc} for \enquote{all other non-critical traffic} \cite[2]{boraten16packetsecurity}. First introduced in 2008
\cite{cramer08amdcodes}, \gls{amd} codes are capable of \enquote{[detecting] any tampering by an adversary} \cite[1]{cramer08amdcodes}.

Following up on their previous work, the authors published a 2018 paper \cite{boraten18mitigationdos} that refines their methods to faciliate hardware
trojan detection and mitigation. In contrast to many of the previously presented works \cites(e.g.)(){ancajas14fortnocs}{frey17hardenednoc}, they aim
to first detect a potential hardware trojan before activating further security measures. The described attacker model employs fault injections to
intentionally trigger responses from the error correction codes (like the \gls{amd} code explored earlier \cite{boraten16packetsecurity}), thus
performing a \gls{dos} attack.

Trojans are discovered with a \enquote{heuristic-based fault detection model} \cite[25]{boraten18mitigationdos} that classifies faults into accidental
and intentional ones. Once this scheme detects the presence of a trojan, additional security measures are employed. First, the authors try to keep
using the malicious links in order to not degrade network performance. Before a packet is routed through an infected area, it is obfuscated to prevent
the hardware trojan from triggering. If this fails, and faults are still being injected, \enquote{links must be disabled and routers should route
around them} \cite[32]{boraten18mitigationdos}.

\citeauthor{stefan11enhancingnocs} \cite{stefan11enhancingnocs} explore the potential of multipath routing as a security enhancement in \glspl{noc}.
Extending the existing \textit{\AE thereal} framework \cite{goossens05aethereal}, they implemented time-division multiplexing for choosing a route at
the sender's network interface. Two variants were pursued: static, deterministic path selection and dynamic selection at run-time (e.g. by using a
hardware random number generator). Through several experiments, they conclude that the static variant has significantly less chip area overhead than
the dynamic one and thus should be the preferred method.

Also focusing on time-division multiplexed \glspl{noc}, \citeauthor{wassel13surfnoc} \cite{wassel13surfnoc} promote the usage of different domains for
the network traffic with strict non-interference requirements. Categorizing packets into such domains \enquote{help[s] prevent cascading failures}
\cite[1]{wassel13surfnoc} and hampers \gls{dos} attacks from affecting the whole system. In their work, the authors propose an efficient method of
this domain-based routing with very low latency, making this security measure practical.

\section{Network Coding For Network-On-Chip}
Few attempts have been made to integrate network coding into \gls{noc} architectures. It was briefly mentioned by
\citeauthor{fragouli08ncapplications} \cite{fragouli08ncapplications}, where emerging network coding applications are discussed. However, it was
mostly seen as a method to help \enquote{simplify and minimize the length of on-chip wiring} \cite[260]{fragouli08ncapplications}, rather than as a
security measure.

\citeauthor{xue15ncnoc} \cite{xue15ncnoc} have integrated network coding into a \gls{noc} architecture for multicast communications. They propose to
send both encoded and regular flits of the same packets into the network, creating a redundant transmission. This introduces benefits during the
routing of the flits, like allowing to drop some flits to potentially prevent network congestion.

\section{Lightweight Cryptographic Algorithms}\label{sec:lightweightcrypto}
For security reasons, it is often desirable to add encryption and authentication to the communication passing through a \gls{noc}, as many of the
researchers mentioned above have done. However,
standard cryptographic algorithms such as \gls{aes} are usually not efficient enough for this task \cite[1]{bogdanov07present}.

In the work preceding this thesis, lightweight cryptographic algorithms were thoroughly explored \cite{harttung17lightweightcrypto}. Such
algorithms are
specifically designed to have efficient hardware implementations with low area and power requirements. In addition, they aim to have a small
computation delay while still providing an adequate level of security. Examples of such algorithms are PRESENT \cite{bogdanov07present},
mCrypton \cite{lim06mcrypton}, PRINCE \cite{borghoff12prince} and Klein \cite{gong12klein}. Some of them will be examined later in this
thesis; see Section (insert vref here) for details. % TODO: reference this when explaining PRINCE later on

\section{Notes}
\begin{itemize}
    \item \textbf{\citetitle{ivanov05nocintroduction}} \checkmark
        \begin{itemize}
            \item Aus dem Jahr 2005, als SoC-Kommunikationsschwierigkeiten wichtiger wurden
            \item Wird als langfristiger Einstiegspunkt in NoC-Forschung gesehen von den Autoren
        \end{itemize}
    \item \textbf{\citetitle{sethumadhavan15trustworthyhardware}} \checkmark
        \begin{itemize}
            \item Introduction into hardware design process and compromisation vectors
            \item Explains how the hardware design and fabrication chain is vulnerable to exploits/attacks
            \item Three security systems operating "in series" (next one is only coming into play if previous one has failed)
                \begin{enumerate}
                    \item Static check that the design being used is backdoor-free
                    \item Runtime altering of inputs (→ obfuscation) to ensure backdoors are not triggered/turned on
                    \item Runtime on-chip monitoring (of instruction counts, opcode types, ...) to detect enabled backdoors
                \end{enumerate}
        \end{itemize}
    \item \textbf{\citetitle{ancajas14fortnocs}} \checkmark
        \begin{itemize}
            \item MPSoCs with 3rd party IP NoCs (i.e. the interconnect system is 3rd party)
            \item Software accomplices (malicious/infected processing elements)
            \item Attack types: eavesdropping (information leak), voluntary data corruption, denial of service
            \item Fort-NoCs: 3-layer security mechanism (hardware level protection)
                \begin{itemize}
                    \item Lower layer data scrambling (hardware encryption to prevent covert activation sequences from AcTh to Trojan)
                    \item Middle layer packet certification (authentication tag, detect unintended destination after flit copy)
                    \item Top layer node obfuscation (migrate running applications from one node to another)
                \end{itemize}
            \item Malicious PE must secretly communicate with hardware trojan to send commands (C\&C node)
            \item Easy to run malicious software on a PE e.g. in cloud computing setups
            \item Small area and power overhead, mostly small runtime overhead
            \item Not all layers need to be used (in lower security domains)
        \end{itemize}
    \item \textbf{\citetitle{frey15stateobfuscation}}
        \begin{itemize}
            \item Attacker model: HT is the FSM control unit of NIs (very specific HT location)
            \item Countermeasure: obfuscate the states and state transistions that the FSMs do
            \item HT modifying state transitions causes FSM to enter illegal/invalid state → HT warning
            \item High HT detection rate (for this specific type of HT)
        \end{itemize}
    \item \textbf{\citetitle{frey17hardenednoc}} \checkmark
        \begin{itemize}
            \item Published two years after state obfuscation paper above
            \item Router level hardware trojans (HTs)
            \item Focuses on DoS attacks (bandwidth depletion) originating in a router (not a NI because router has more connections → more
                feasible)
            \item Implement DoS mitigation directly in the routers, rather than NI, to prevent bandwidth depletion as quickly as possible
            \item Physically Unclonable Function (PUF): random vector generation in each router
            \item Apply random dynamic permutation (data scrambling) to flits arriving at a router input (makes modifying flits into something
                meaningful significantly harder) before flit reaches the input queue (where the HT has access); de-permutate at output port (→
                PUF random vectors)
            \item Apply ECC (error control code) encoding before input port; decode before output port (only critical flit bits: header, tail,
                dest. address)
            \item Check flit integrity after leaving input queue and right before departing through the computed output port
            \item Cites lots of useful other related work
        \end{itemize}
    \item \textbf{\citetitle{fernandes16nocrouting}} \checkmark
        \begin{itemize}
            \item "Attacks at MPSoC aim to extract sensitive data, modify the system behavior or denial the system operation (Denial-of-Service,
                DoS)"
            \item Build security zones in the NoC using routing algorithm ("wrap IPs and protect sensitive information from attacker")
            \item Firewalls also possible, but may be costly (→ they implement a security policy in the NI)
            \item Aims to protect against software-based attacks (NoC is assumed to be secure)
            \item Threat model: timing and DoS attacks
            \item Security zone is e.g. the set of IP blocks that an application was mapped on
            \item Routing algorithm tries to keep the sensitive path completely inside the same security zone, if possible
        \end{itemize}
    \item \textbf{\citetitle{boraten16packetsecurity}} \checkmark
        \begin{itemize}
            \item Packet-Security (P-Sec)
            \item Threat model: compromised NoC does fault injection (side channel attack)
            \item It is possible to eventually obtain encryption keys by observing how encoders and decoders react to the side channel attacks
            \item → ensure integrity of packets using error correction codes (ECCs) (→ AMD, CRC)
            \item AMD for sensitive communications (together with encryption), otherwise CRC to provide minimal fault tolerance
        \end{itemize}
    \item \textbf{\citetitle{boraten18mitigationdos}} \checkmark
        \begin{itemize}
            \item Published 2 year after Packet Security paper above (builds upon previous research)
            \item HT does DoS attack: inspect packets, inject fault, trigger ECC response (ECC cannot correct error) → repeated transmissions,
                deadlocks
            \item HT resides in links between nodes
            \item Prevention: Heuristic fault classification → discover HTs
            \item Continue using compromised links instead of rerouting → obfuscation to prevent HT triggering, optimized AMDs to detect fault
                injections
            \item Little overhead: 2\% area, 6\% power
            \item "[...] we can classify security threats for NoCs as a subset of preexisting challenges originating from but not limited to,
                on-chip fault tolerance, functional correctness, path diversity, isolation, and quality of service"
            \item Security measures should not be compromised themselves
        \end{itemize}
    \item \textbf{\citetitle{biswas15routerattack}}
        \begin{itemize}
            \item Survey of MPSoC attack types
            \item New attack type for routing table-based routers (i.e. reconfigurable routers as opposed to routers with fixed routing logic)
            \item Mentions survey of hardware trojan detection techniques
            \item Not about detecting HTs, but about protection from malicious users
            \item → TEEs and REEs (Trusted/Rich Execution Environments), similar to security zones
            \item It is desirable to use routing tables instead of fixed routing logic (flexibility, more complex routing algorithms)
            \item Attack scenario: routing table is loaded onto NoC at boot or runtime (by host processor or NoC controller), which is modified by
                the attacker → unauthorized access and misrouting (routing to other environment)
        \end{itemize}
    \item \textbf{\citetitle{gebotys03securityframework}} \checkmark
        \begin{itemize}
            \item Framework: protection both at network and application layer
            \item Network layer
                \begin{itemize}
                    \item Key-keeper core: protects/distributes encryption keys to other secure cores
                    \item Each secure core has a security wrapper
                    \item Focus on key distribution and key management
                \end{itemize}
            \item Application layer
                \begin{itemize}
                    \item Software modifications for resistance against power (side-channel) attacks
                \end{itemize}
            \item Higher level approach than most other papers (more protocol layer than hardware layer)
            \item Strong assumptions on trusted software and hardware
            \item No clear attacker model, paper seems more like a "framework suggestion"
        \end{itemize}
    \item \textbf{\citetitle{kapoor13nocauthenc}} \checkmark
        \begin{itemize}
            \item 2 NoC zones: secure and non-secure IP cores
            \item Authenticated Encryption implemented in NIs of secure cores
            \item Secure cores can communicate with each other using permanent keys
            \item Non-secure cores can communicate with each other using plain text
            \item Hardware (NIs + routers) are assumed to be secure
            \item Secure and non-secure cores communicate with session keys and an intermediate link IP core (link can be secure or non-secure)
            \item Memory IP cores have access rights table in NI to prevent unauthorized memory accesses
            \item DoS attacks prevented by having a max number of packets allowed to be sent implemented in NI
        \end{itemize}
    \item \textbf{\citetitle{evain05nocsecurityanalysis}}
        \begin{itemize}
            \item In their context: CCM (central configuration module) is added (unique IP block → initialize and (re)configure NoC). Also CCM:
                add supervising and defending reactions for security
            \item FPGA vs. ASIC: reconfigurability of FPGA is another potential attack vector
            \item Mixed FPGA/ASIC implementation possible: ASIC for secure zone, FPGA for insecure zone (CCM must be in secure zone)
            \item Many possible attack types → different protection strategies
                \begin{itemize}
                    \item Bandwidth denial: virtual channels in the secure area (unsecure packets can't obstruct secure packets)
                    \item Unauthorized access: packet/path filters at zone boundaries and/or at NIs
                    \item Only encrypted/authenticated communication with the CCM
                \end{itemize}
        \end{itemize}
    \item \textbf{\citetitle{stefan11enhancingnocs}}
        \begin{itemize}
            \item Introduce non-determinism through multipath routing
            \item Proposal is implemented on top of Aethereal framework
            \item Time-division multiplexing (TDM) for router channels
            \item Alternative path selection
                \begin{itemize}
                    \item … based on position in the slot table at the moment of sending (static schedule)
                    \item … based on hardware RNG (dynamic at runtime)
                \end{itemize}
        \end{itemize}
\end{itemize}

Different attacker/threat models in literature. Depending on the attacker model, different approaches are used to protect the system against it.
E.g. when the underlying network architecture (the NoC itself) is assumed to be compromised, protection is implemented in the network interfaces
of the nodes. If the attacker only has access to specific parts of the routers or specific zones of the NoC, protection can be implemented through
the routing algorithm. → The power of the HTs differs. The more complex the HT is, the stronger it influences chip area/power consumption/runtime
overhead and may be easier detectable → that's why HTs are often assumed to use "small" attacks like fault injection, or have access to only very
specific components of the NoC to stay undetected/not require much chip area.

Differentiate between methods to detect HTs (on software level, firmware level, w/ static analysis, side-channel analysis), and methods to harden
the NoC against potential HT infections.

NI is usually assumed to be trusted, and routers are potentially compromised because of 3rd party IP or 3rd party manufacturing/integration
partners. Other threat model: software attacks (NoC itself is secure).

How to get HT into hardware: rogue employee, 3rd party IP, 3rd party manufacturing/integration partners, ...

This thesis: no hardware synthesis, use software simulation. Focus on malicious flit modification (→ attacker model) rather than DoS attacks. Our
model assumes that the NoC routers and links may be compromised and thus relies on the NIs for the security measures → no effective protection
against bandwidth depletion, but this is not the goal.
Deterministic vs. static routing? No security zones or division into secure/non-secure zones/cores.

The concept of security zones can be implemented in different ways. Bla et al. propose to do X, while bla enforce them through the routing protocol.

